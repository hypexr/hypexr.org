<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>bibtool.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3-rc1 -->
<center>
<a class="qindex" href="main.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>bibtool.cpp</h1><a href="bibtool_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">/* Scott Rippee</span>
00002 <span class="comment">   CSci 151</span>
00003 <span class="comment">   Bibtool Functions</span>
00004 <span class="comment">*/</span>
00005 
00006 <span class="preprocessor">#include "<a class="code" href="bibtool_8h.html">bibtool.h</a>"</span>
00007 
<a name="l00008"></a><a class="code" href="classBibtool.html#Bibtoola0">00008</a> <span class="comment">//Bibtool class constructor</span>
00009 <a class="code" href="classBibtool.html#Bibtoola0">Bibtool::Bibtool</a>()
00010 {
00011         <a class="code" href="classBibtool.html#Bibtoolm11">searchNames_vec</a>.clear();
00012         <a class="code" href="classBibtool.html#Bibtoolm12">searchNamesAuth_vec</a>.clear();
00013         <a class="code" href="classBibtool.html#Bibtoolm13">searchNamesTitle_vec</a>.clear();
00014 }
00015 
00016 
<a name="l00017"></a><a class="code" href="classBibtool.html#Bibtoola5">00017</a> <span class="comment">//peek if at end of file and return a boolean</span>
00018 <span class="keywordtype">bool</span> <a class="code" href="classBibtool.html#Bibtoola5">Bibtool::endOfFile</a>()
00019 {
00020         <span class="keywordtype">bool</span> endfile;
00021         <span class="keywordflow">if</span>( <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.peek() == EOF )
00022                 endfile = <span class="keyword">true</span>;
00023         <span class="keywordflow">else</span>
00024                 endfile = <span class="keyword">false</span>;
00025 
00026         <span class="keywordflow">return</span> endfile;
00027 }
00028 
00029 
00030 <span class="comment">//Processes the entry, counting quotes, brackets, and commas</span>
<a name="l00031"></a><a class="code" href="classBibtool.html#Bibtoola3">00031</a> <span class="comment">//calls getName to extract the name fron the entry</span>
00032 <span class="keywordtype">void</span> <a class="code" href="classBibtool.html#Bibtoola3">Bibtool::processEntry</a>()
00033 {
00034         <span class="keywordtype">char</span> ch[1];                     <span class="comment">//used to hold each character</span>
00035         stack&lt;char&gt; parse_stack;
00036 
00037         <span class="comment">//first character should be '{' character so move over it</span>
00038         <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.read( (<span class="keywordtype">char</span> *)ch, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>) );
00039 
00040         <span class="keywordflow">if</span>( ch[0] == <span class="charliteral">'{'</span> )              <span class="comment">//if the next character after white space is not {</span>
00041         {                               <span class="comment">//there is a problem</span>
00042                                         <span class="comment">//will move on.. searching for next @ symbol</span>
00043                 parse_stack.push( ch[0] );
00044 
00045                 <span class="keywordflow">if</span>( validType )
00046                 {
00047                         <a class="code" href="classBibtool.html#Bibtoolc0">getName</a>();
00048 
00049                         <a class="code" href="classBibtool.html#Bibtoolc1">parseEntry</a>( parse_stack );
00050 
00051                         <span class="keywordflow">if</span>( !parse_stack.empty() ) {    <span class="comment">//if its not empty when it comes back then problem</span>
00052                                 cout&lt;&lt; endl&lt;&lt; <span class="stringliteral">"--Error in entry formatting."</span>
00053                                     &lt;&lt; <span class="stringliteral">"  Entry: "</span>&lt;&lt; <a class="code" href="classBibtool.html#Bibtoolo2">keyName</a>&lt;&lt; <span class="stringliteral">"  File:  "</span>&lt;&lt;<a class="code" href="classBibtool.html#Bibtoolm9">currentBibFileName</a>;
00054 
00055                                 <span class="comment">//remove pop everything off of stack</span>
00056                                 <span class="keywordflow">while</span>( !parse_stack.empty() )
00057                                         parse_stack.pop();
00058                         }
00059                 }
00060 
00061         }
00062 }
00063 
00064 
00065 <span class="comment">//move through file finding { and }..  and extract author and title</span>
00066 <span class="comment">//uses the stack to know when it has poped the last } it needs to</span>
00067 <span class="comment">//can be done with out using the stack by using recursion</span>
00068 <span class="comment">//by removing all stack info and uncommenting the return; after the pop</span>
<a name="l00069"></a><a class="code" href="classBibtool.html#Bibtoolc1">00069</a> <span class="comment">//and calling its self after the else push.    Which way faster????</span>
00070 <span class="keywordtype">void</span> <a class="code" href="classBibtool.html#Bibtoolc1">Bibtool::parseEntry</a>( stack&lt;char&gt; &amp;parse_stack )
00071 {
00072         <span class="keywordtype">char</span> ch[1];
00073         string temp, label;
00074         <span class="keywordtype">bool</span> skipChar = <span class="keyword">false</span>;
00075         stack&lt;char&gt; field_stack;
00076         <span class="comment">//int temp_count=0;             //counts number of characters so I don't take more than 20 in</span>
00077 
00078         <span class="comment">//starts before ','</span>
00079         <span class="keywordflow">while</span>( <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.peek() != EOF &amp;&amp; !parse_stack.empty() )
00080         {
00081                 <span class="keywordflow">while</span>( <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.peek() == <span class="charliteral">' '</span> || <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.peek() == <span class="charliteral">'\n'</span> || 
00082                        <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.peek() == 0x0d || <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.peek() == <span class="charliteral">','</span> ||
00083                        <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.peek() == <span class="charliteral">'\t'</span> )
00084                         <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.read( (<span class="keywordtype">char</span>*)ch, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>) );
00085 
00086                 label.erase();                          <span class="comment">//clear previous info</span>
00087 
00088                 <span class="comment">//extract label (ex. author, title)</span>
00089                 <span class="comment">//while loop reads until it finds a space, =, nl, or tab</span>
00090                 <span class="keywordflow">while</span>( <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.peek() != <span class="charliteral">' '</span> &amp;&amp; <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.peek() != <span class="charliteral">'='</span> &amp;&amp; <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.peek() != <span class="charliteral">'\t'</span> &amp;&amp;
00091                        <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.peek() != <span class="charliteral">'\n'</span> &amp;&amp; <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.peek() != 0x0d )
00092                 {
00093                         <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.read( (<span class="keywordtype">char</span>*)ch, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>) );
00094                         temp=ch[0];
00095                         label.insert( label.length(), temp );
00096                 }
00097 
00098                 <span class="comment">//Clear blanks, newlines, tabs, = sign so We will be at the " or {</span>
00099                 <span class="keywordflow">while</span>( <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.peek() == <span class="charliteral">' '</span> || <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.peek() == <span class="charliteral">'\n'</span> || 
00100                        <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.peek() == 0x0d || <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.peek() == <span class="charliteral">'='</span> ||
00101                        <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.peek() == <span class="charliteral">'\t'</span> )
00102                         <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.read( (<span class="keywordtype">char</span>*)ch, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>) );
00103 
00104                 <span class="keywordflow">for</span>( <span class="keywordtype">int</span> x=0; x&lt;label.length(); x++ )   <span class="comment">//convert to lower case</span>
00105                         label[x] = tolower(label[x]);
00106 
00107                 <span class="keywordflow">if</span>( label == <span class="stringliteral">"author"</span> || label == <span class="stringliteral">"title"</span> )     
00108                 {
00109                         <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.read( (<span class="keywordtype">char</span>*)ch, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>) );
00110                         <span class="keywordflow">if</span>( ch[0] == <span class="charliteral">'"'</span> || ch[0] == <span class="charliteral">'{'</span> )
00111                                 field_stack.push( ch[0] );
00112                         <span class="keywordflow">else</span>
00113                                 cout&lt;&lt; <span class="stringliteral">"Warning!  Didn't find a \" or { following the equal sign."</span>&lt;&lt; endl;
00114 
00115                         <a class="code" href="classBibtool.html#Bibtoolo10">authTmp</a>.erase();
00116                         <a class="code" href="classBibtool.html#Bibtoolo11">titleTmp</a>.erase();
00117                         <span class="comment">//temp_count = 0;</span>
00118                         <span class="keywordflow">while</span>( !field_stack.empty() )<span class="comment">// &amp;&amp; temp_count &lt; 20 )</span>
00119                         {
00120                                 skipChar = <span class="keyword">false</span>;
00121                                 <span class="comment">//extract author name field</span>
00122                                 <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.read( (<span class="keywordtype">char</span>*)ch, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>) );
00123 
00124                                 <span class="keywordflow">if</span>( ch[0] == <span class="charliteral">'\\'</span> ) {
00125                                         <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.read( (<span class="keywordtype">char</span>*) ch, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>) );
00126                                         <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.read( (<span class="keywordtype">char</span>*) ch, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>) );
00127                                 }
00128 
00129                                 <span class="comment">//remove puncuations</span>
00130                                 <span class="keywordflow">if</span>( ch[0] == <span class="charliteral">'.'</span> || ch[0] == <span class="charliteral">','</span> || ch[0] == <span class="charliteral">'\''</span> || ch[0] == <span class="charliteral">'!'</span> ||
00131                                     ch[0] == <span class="charliteral">';'</span> || ch[0] == <span class="charliteral">':'</span> || ch[0] == <span class="charliteral">'['</span> || ch[0] == <span class="charliteral">']'</span> ||
00132                                     ch[0] == <span class="charliteral">'`'</span> || ch[0] == <span class="charliteral">'?'</span> )
00133                                         skipChar = <span class="keyword">true</span>;
00134 
00135                                 <span class="keywordflow">if</span>( ch[0] != <span class="charliteral">'"'</span> &amp;&amp; ch[0] != <span class="charliteral">'{'</span> &amp;&amp; ch[0] != <span class="charliteral">'}'</span> )
00136                                 {
00137                                         <span class="comment">//Some entries have large amounts of spaces in author field</span>
00138                                         <span class="comment">//this removes them</span>
00139                                         <span class="keywordflow">while</span>( (ch[0] == <span class="charliteral">' '</span> &amp;&amp; <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.peek() == <span class="charliteral">' '</span>) || (ch[0] == <span class="charliteral">'\t'</span>) ) {
00140                                                 <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.read( (<span class="keywordtype">char</span>*) ch, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>) );
00141                                         }
00142                         
00143                                         <span class="keywordflow">if</span>( ch[0] == <span class="charliteral">' '</span> )
00144                                                 skipChar = <span class="keyword">true</span>;
00145                                         
00146                                         <span class="keywordflow">if</span>( ch[0] != 0x0d ) {
00147                                                 <span class="keywordflow">if</span>( ch[0] != <span class="charliteral">'\n'</span> &amp;&amp; !skipChar ) {
00148                                                         temp = ch[0];
00149                                                         <span class="keywordflow">if</span>( label == <span class="stringliteral">"author"</span> )
00150                                                                 <a class="code" href="classBibtool.html#Bibtoolo10">authTmp</a>.insert( <a class="code" href="classBibtool.html#Bibtoolo10">authTmp</a>.length(), temp );
00151                                                         <span class="keywordflow">else</span>
00152                                                                 <a class="code" href="classBibtool.html#Bibtoolo11">titleTmp</a>.insert( <a class="code" href="classBibtool.html#Bibtoolo11">titleTmp</a>.length(), temp );
00153                                                         
00154                                                 }
00155                                         }
00156 
00157                                         <span class="comment">//after it takes character is it is a ' ' then we got the word</span>
00158                                         <span class="keywordflow">if</span>( ch[0] == <span class="charliteral">' '</span> || ch[0] == 0x0d ) {   <span class="comment">//need to write word to ndx author</span>
00159                                                 <span class="keywordflow">if</span>( label == <span class="stringliteral">"author"</span> )
00160                                                 {
00161                                                         <span class="keywordflow">if</span>( <a class="code" href="classBibtool.html#Bibtoolo10">authTmp</a> != <span class="stringliteral">"and"</span> ) {
00162                                                                 <span class="comment">//convert key name to lowercase</span>
00163                                                                 <span class="keywordflow">for</span>( <span class="keywordtype">int</span> x=0; x&lt;<a class="code" href="classBibtool.html#Bibtoolo10">authTmp</a>.length(); x++ ) <span class="comment">//convert to lower case</span>
00164                                                                         <a class="code" href="classBibtool.html#Bibtoolo10">authTmp</a>[x] = tolower(<a class="code" href="classBibtool.html#Bibtoolo10">authTmp</a>[x]);
00165 
00166                                                                 <span class="comment">//if longer than 20 char then its a problem</span>
00167                                                                 <span class="keywordflow">if</span>( <a class="code" href="classBibtool.html#Bibtoolo10">authTmp</a>.length() &gt; 20 )
00168                                                                         <a class="code" href="classBibtool.html#Bibtoolo10">authTmp</a>.erase( 20, 20-<a class="code" href="classBibtool.html#Bibtoolo10">authTmp</a>.length() );
00169 
00170                                                                 <span class="comment">//call function to write secondary index and lst</span>
00171 
00172                                                                 <span class="comment">//###</span>
00173                                                                 <span class="comment">//write_ndx_author();</span>
00174                                                                 <span class="comment">//searchAuthor();</span>
00175                                                                 <span class="comment">//instead lets add the author name to a binary search tree</span>
00176 
00177                                                                 <span class="comment">//convert to lowercase for compairson</span>
00178                                                                 <span class="keywordflow">for</span>( <span class="keywordtype">int</span> x=0; x&lt;<a class="code" href="classBibtool.html#Bibtoolo10">authTmp</a>.length(); x++)
00179                                                                         <a class="code" href="classBibtool.html#Bibtoolo10">authTmp</a>[x] = tolower( <a class="code" href="classBibtool.html#Bibtoolo10">authTmp</a>[x] );
00180 
00181                                                                 <a class="code" href="classBibtool.html#Bibtoolm14">bstree</a>.<a class="code" href="classbstreeBibIndex.html#bstreeBibIndexm1">authorNdx</a>.insert( <a class="code" href="classBibtool.html#Bibtoolo10">authTmp</a> );
00182                                                                 <span class="comment">//hasttb.authorNdx.insert( authTmp );</span>
00183                                                                 <a class="code" href="classBibtool.html#Bibtoolm15">rbtree</a>.<a class="code" href="classrbtreeBibIndex.html#rbtreeBibIndexm1">authorNdx</a>.insert( <a class="code" href="classBibtool.html#Bibtoolo10">authTmp</a> );
00184                                                                 
00185                                                         }
00186                                                         <a class="code" href="classBibtool.html#Bibtoolo10">authTmp</a>.erase();
00187                                                 } <span class="keywordflow">else</span> {                <span class="comment">//esle lable is title. leave out and and the</span>
00188                                                         <span class="keywordflow">if</span>( <a class="code" href="classBibtool.html#Bibtoolo11">titleTmp</a> != <span class="stringliteral">"and"</span> &amp;&amp; <a class="code" href="classBibtool.html#Bibtoolo11">titleTmp</a> != <span class="stringliteral">"the"</span> ) {
00189                                                                 <span class="comment">//convert key name to lowercase</span>
00190                                                                 <span class="keywordflow">for</span>( <span class="keywordtype">int</span> x=0; x&lt;<a class="code" href="classBibtool.html#Bibtoolo11">titleTmp</a>.length(); x++ )        <span class="comment">//convert to lower case</span>
00191                                                                         <a class="code" href="classBibtool.html#Bibtoolo11">titleTmp</a>[x] = tolower(<a class="code" href="classBibtool.html#Bibtoolo11">titleTmp</a>[x]);
00192 
00193                                                                 <span class="comment">//if longer than 20 char then its a problem</span>
00194                                                                 <span class="keywordflow">if</span>( <a class="code" href="classBibtool.html#Bibtoolo11">titleTmp</a>.length() &gt; 20 )
00195                                                                         <a class="code" href="classBibtool.html#Bibtoolo11">titleTmp</a>.erase( 20, 20-<a class="code" href="classBibtool.html#Bibtoolo11">titleTmp</a>.length() );
00196 
00197                                                                 <span class="comment">//call function to write secondary index and lst</span>
00198 
00199                                                                 <span class="comment">//###</span>
00200                                                                 <span class="comment">//write_ndx_title();</span>
00201                                                                 <span class="comment">//searchTitle();</span>
00202 
00203                                                                 <span class="comment">//convert to lowercase for compairson</span>
00204                                                                 <span class="keywordflow">for</span>( <span class="keywordtype">int</span> x=0; x&lt;<a class="code" href="classBibtool.html#Bibtoolo11">titleTmp</a>.length(); x++)
00205                                                                 <a class="code" href="classBibtool.html#Bibtoolo11">titleTmp</a>[x] = tolower( <a class="code" href="classBibtool.html#Bibtoolo11">titleTmp</a>[x] );
00206 
00207                                                                 <a class="code" href="classBibtool.html#Bibtoolm14">bstree</a>.<a class="code" href="classbstreeBibIndex.html#bstreeBibIndexm2">titleNdx</a>.insert( <a class="code" href="classBibtool.html#Bibtoolo11">titleTmp</a> );
00208                                                                 <span class="comment">//hashtb.titleNdx.insert( titleTmp );</span>
00209                                                                 <a class="code" href="classBibtool.html#Bibtoolm15">rbtree</a>.<a class="code" href="classrbtreeBibIndex.html#rbtreeBibIndexm2">titleNdx</a>.insert( <a class="code" href="classBibtool.html#Bibtoolo11">titleTmp</a> );
00210                                                         }
00211                                                         <a class="code" href="classBibtool.html#Bibtoolo11">titleTmp</a>.erase();
00212                                                 }
00213                                         }
00214 
00215                                 } <span class="keywordflow">else</span> {
00216                                         <span class="comment">//else it must be a " { or } and each one effects THe stack</span>
00217                                         <span class="keywordflow">if</span>( ch[0] == <span class="charliteral">'"'</span> ) {
00218                                                 <span class="keywordflow">if</span>( field_stack.top() == <span class="charliteral">'"'</span> )
00219                                                         field_stack.pop();
00220                                                 <span class="keywordflow">else</span>
00221                                                         field_stack.push( ch[0] );
00222                                         }
00223 
00224                                         <span class="keywordflow">if</span>( ch[0] == <span class="charliteral">'}'</span>) {
00225                                                 <span class="keywordflow">if</span>( field_stack.top() == <span class="charliteral">'{'</span> )
00226                                                         field_stack.pop();
00227                                                 <span class="keywordflow">else</span> {
00228                                                         <span class="keywordflow">if</span>( label == <span class="stringliteral">"author"</span> ) {
00229                                                                 cout&lt;&lt; <span class="stringliteral">"Warning! found a } in authorfield"</span>
00230                                                                     &lt;&lt; <span class="stringliteral">"but no { previously. In keyName: "</span>
00231                                                                     &lt;&lt; <a class="code" href="classBibtool.html#Bibtoolo2">keyName</a> &lt;&lt; endl;
00232                                                         } <span class="keywordflow">else</span> {
00233                                                                 cout&lt;&lt; <span class="stringliteral">"Warning! found a } in titlefield"</span>
00234                                                                     &lt;&lt; <span class="stringliteral">"but no { previously. In keyName: "</span>
00235                                                                     &lt;&lt; <a class="code" href="classBibtool.html#Bibtoolo2">keyName</a> &lt;&lt; endl;
00236                                                         }
00237                                                 }
00238                                         }
00239 
00240                                         <span class="keywordflow">if</span>( ch[0] == <span class="charliteral">'{'</span> )
00241                                                 field_stack.push( ch[0] );
00242                                 }
00243 
00244                         }
00245                 } <span class="keywordflow">else</span> {
00246                         <span class="comment">//field found is not author.  We still want to parse the field</span>
00247                         <span class="comment">//because we want to end up at at the , before the next field name</span>
00248                         <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.read( (<span class="keywordtype">char</span>*)ch, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>) );
00249 
00250                         <span class="comment">//next character should be " or { or } but sometimes not..</span>
00251                         <span class="comment">//when not will just check for ending comma</span>
00252                         <span class="keywordflow">if</span>( ch[0] == <span class="charliteral">'"'</span> || ch[0] == <span class="charliteral">'{'</span> )
00253                         {
00254                                 field_stack.push( ch[0] );
00255 
00256                                 <span class="keywordflow">while</span>( !field_stack.empty() )
00257                                 {
00258                                         <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.read( (<span class="keywordtype">char</span>*) ch, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>) );
00259 
00260                                         <span class="keywordflow">if</span>( ch[0] == <span class="charliteral">'\\'</span> ) {
00261                                                 <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.read( (<span class="keywordtype">char</span>*) ch, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>) );
00262                                                 <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.read( (<span class="keywordtype">char</span>*) ch, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>) );
00263                                         }
00264 
00265                                         <span class="keywordflow">if</span>( ch[0] == <span class="charliteral">'"'</span> ) {
00266                                                 <span class="keywordflow">if</span>( field_stack.top() == <span class="charliteral">'"'</span> )
00267                                                         field_stack.pop();
00268                                                 <span class="keywordflow">else</span>
00269                                                         field_stack.push( ch[0] );
00270                                         }
00271 
00272                                         <span class="keywordflow">if</span>( ch[0] == <span class="charliteral">'}'</span>) {
00273                                                 <span class="keywordflow">if</span>( field_stack.top() == <span class="charliteral">'{'</span> )
00274                                                         field_stack.pop();
00275                                                 <span class="keywordflow">else</span> {
00276                                                         cout&lt;&lt; <span class="stringliteral">"Warning! Found a } in field but no { previously. In keyName: "</span>&lt;&lt; <a class="code" href="classBibtool.html#Bibtoolo2">keyName</a>&lt;&lt; endl;
00277                                                 }
00278                                         }
00279 
00280                                         <span class="keywordflow">if</span>( ch[0] == <span class="charliteral">'{'</span> )
00281                                                 field_stack.push( ch[0] );
00282                                 }
00283                                 
00284                         } <span class="keywordflow">else</span> {
00285                                 <span class="comment">//search for comma</span>
00286                                 <span class="keywordflow">while</span>( <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.peek() != <span class="charliteral">','</span> )
00287                                         <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.read( (<span class="keywordtype">char</span>*) ch, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>) );
00288                         }
00289                 }
00290         
00291                 <span class="comment">//want to read blanks and check if entry is over (meaning } )</span>
00292                 <span class="keywordflow">while</span>( <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.peek() == <span class="charliteral">' '</span> || <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.peek() == <span class="charliteral">'\n'</span> || 
00293                        <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.peek() == 0x0d || <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.peek() == <span class="charliteral">'\t'</span> )
00294                         <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.read( (<span class="keywordtype">char</span>*)ch, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>) );
00295 
00296                 <span class="keywordflow">if</span>( <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.peek() == <span class="charliteral">'}'</span> )
00297                 {
00298                         parse_stack.pop();
00299                 }
00300 
00301                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.peek() != <span class="charliteral">','</span>)     <span class="comment">//else next char should be a ,</span>
00302                 {
00303                         cout&lt;&lt; <span class="stringliteral">"Warning! Suppose to find '}' for end of entry or ',' meaning more fields. in keyName: "</span>&lt;&lt; <a class="code" href="classBibtool.html#Bibtoolo2">keyName</a>&lt;&lt; endl;
00304                         <span class="comment">//things are messed up so finding } will hopefully take to the ned of entry</span>
00305                         <span class="keywordflow">while</span>( <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.peek() != <span class="charliteral">'}'</span> &amp;&amp; <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.peek() != <span class="charliteral">','</span> )
00306                                 <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.read( (<span class="keywordtype">char</span>*) ch, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>) );
00307 
00308                                 <span class="keywordflow">if</span>( <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.peek() == <span class="charliteral">'}'</span> ) {
00309                                         <span class="comment">//found a } somewhere so do a pop</span>
00310                                         parse_stack.pop();
00311                                 }
00312                 } <span class="keywordflow">else</span> {
00313                         <span class="comment">//if the next character is a ',' then need to ckeck character after</span>
00314                         <span class="comment">//that because it might be }, meaning the end of entry</span>
00315                         <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.read( (<span class="keywordtype">char</span>*) ch, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>) );
00316 
00317                         <span class="comment">//remove blanks</span>
00318                         <span class="keywordflow">while</span>( <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.peek() == <span class="charliteral">' '</span> || <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.peek() == <span class="charliteral">'\n'</span> || 
00319                                <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.peek() == 0x0d || <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.peek() == <span class="charliteral">'\t'</span> )
00320                                 <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.read( (<span class="keywordtype">char</span>*)ch, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>) );
00321 
00322                         <span class="keywordflow">if</span>( <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.peek() == <span class="charliteral">'}'</span> )
00323                                 parse_stack.pop();
00324                 }
00325         }
00326         <span class="keywordflow">return</span>;
00327 }
00328 
00329 
<a name="l00330"></a><a class="code" href="classBibtool.html#Bibtoolc0">00330</a> <span class="comment">//Pull name of entry from file</span>
00331 <span class="keywordtype">void</span> <a class="code" href="classBibtool.html#Bibtoolc0">Bibtool::getName</a>()
00332 {
00333         <span class="keywordtype">int</span> nameLength=0;                       <span class="comment">//length of entry name</span>
00334         string temp;
00335         <a class="code" href="classBibtool.html#Bibtoolo2">keyName</a>.erase();                        <span class="comment">//clear because there might be left-overs</span>
00336         <span class="keywordtype">char</span> ch[1];                             <span class="comment">//used to hold each character</span>
00337         
00338         <span class="comment">//extract name  When ends will be pointing to ','</span>
00339         <span class="keywordflow">while</span>( <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.peek() != <span class="charliteral">','</span> &amp;&amp; nameLength &lt; 20 )
00340         {
00341                 <span class="comment">//move over white space and don't suck up new line characters</span>
00342                 <span class="keywordflow">while</span>( <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.peek() == <span class="charliteral">' '</span> || <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.peek() == <span class="charliteral">'\n'</span> || 
00343                        <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.peek() == 0x0d || <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.peek() == <span class="charliteral">'\t'</span> )
00344                         <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.read( (<span class="keywordtype">char</span> *)ch, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>) );
00345 
00346                 <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.read( (<span class="keywordtype">char</span> *)ch, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>) );
00347                 temp=ch[0];
00348                 <a class="code" href="classBibtool.html#Bibtoolo2">keyName</a>.insert( nameLength, temp );
00349                 nameLength++;
00350 
00351                 <span class="comment">//move over white space</span>
00352                 <span class="keywordflow">while</span>( <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.peek() == <span class="charliteral">' '</span> || <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.peek() == <span class="charliteral">'\n'</span> ||
00353                        <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.peek() == 0x0d || <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.peek() == <span class="charliteral">'\t'</span> )
00354                         <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.read( (<span class="keywordtype">char</span> *)ch, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>) );
00355         }
00356         <span class="comment">//here it has found name (keyName) now check it against searchlist file</span>
00357 <span class="comment">//      if ( !searchNdx() ) {                   //if name is not already in the .ndx file</span>
00358                 <span class="comment">//writeIndex();                 //write info to index file</span>
00359                 
00360                 <span class="comment">//###</span>
00361                 <span class="comment">//convert to lowercase for compairson</span>
00362                 <span class="keywordflow">for</span>( <span class="keywordtype">int</span> x=0; x&lt;<a class="code" href="classBibtool.html#Bibtoolo2">keyName</a>.length(); x++)
00363                 <a class="code" href="classBibtool.html#Bibtoolo2">keyName</a>[x] = tolower( <a class="code" href="classBibtool.html#Bibtoolo2">keyName</a>[x] );
00364 
00365                 <a class="code" href="classBibtool.html#Bibtoolm14">bstree</a>.<a class="code" href="classbstreeBibIndex.html#bstreeBibIndexm0">primaryNdx</a>.insert( <a class="code" href="classBibtool.html#Bibtoolo2">keyName</a> );    <span class="comment">//put the key name into binary search tree</span>
00366                 <span class="comment">//hashtb.primaryNdx.insert( keyName );</span>
00367                 <a class="code" href="classBibtool.html#Bibtoolm15">rbtree</a>.<a class="code" href="classrbtreeBibIndex.html#rbtreeBibIndexm0">primaryNdx</a>.insert( <a class="code" href="classBibtool.html#Bibtoolo2">keyName</a> );
00368 
00369                 <span class="comment">//test if key name is equal to any key neames in searchNames_vec</span>
00370                 <span class="keywordflow">if</span>( schLstIsOpenable ) {
00371                         <span class="comment">//compairW(thSearchNames();</span>
00372                 }
00373 <span class="comment">//      }</span>
00374 }
00375 
00376         
00377 <span class="comment">//Find the type of the entry</span>
<a name="l00378"></a><a class="code" href="classBibtool.html#Bibtoola2">00378</a> <span class="comment">//left pointing to '{' at the end of type name</span>
00379 <span class="keywordtype">bool</span> <a class="code" href="classBibtool.html#Bibtoola2">Bibtool::getType</a>()
00380 {
00381         <span class="keywordtype">int</span> nameLength = 0;
00382         string temp;
00383         <span class="keywordtype">bool</span> done = <span class="keyword">false</span>;
00384         <span class="keywordtype">bool</span> foundEntry = <span class="keyword">false</span>;
00385         <span class="keywordtype">char</span> ch[1];                     <span class="comment">//used to hold each character</span>
00386 
00387         <span class="comment">//move through file character by character looking looking for entries</span>
00388         <span class="keywordflow">while</span>( <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.peek() != EOF &amp;&amp; !done )
00389         {
00390                 <a class="code" href="classBibtool.html#Bibtoolo1">type</a>.erase();           <span class="comment">//clear type filed incase already set</span>
00391                 <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.read( (<span class="keywordtype">char</span> *)ch, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>) );
00392                 <a class="code" href="classBibtool.html#Bibtoolo6">validType</a>=<span class="keyword">true</span>;
00393 
00394                 <span class="keywordflow">if</span>( ch[0] == <span class="charliteral">'@'</span> )
00395                 {
00396                         nameLength = 0;
00397                         foundEntry = <span class="keyword">true</span>;
00398 
00399                         <span class="comment">//character index is here.. save for writing to .ndx file</span>
00400                         <a class="code" href="classBibtool.html#Bibtoolo5">characterIndex</a> = <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.tellg();   <span class="comment">//minus one because @ was already read in</span>
00401                         <a class="code" href="classBibtool.html#Bibtoolo5">characterIndex</a>--;
00402                 
00403                         <span class="comment">//is 20 characters the max length specified??</span>
00404                         <span class="keywordflow">while</span>( <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.peek() != <span class="charliteral">'{'</span> &amp;&amp; nameLength &lt; 20 )
00405                         {
00406                                 <span class="comment">//ignore white space before read</span>
00407                                 <span class="keywordflow">while</span>( <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.peek() == <span class="charliteral">' '</span> ||
00408                                        <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.peek() == <span class="charliteral">'\n'</span> ||
00409                                        <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.peek() == 0x0d ||
00410                                        <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.peek() == <span class="charliteral">'\t'</span> )
00411                                 {       
00412                                         <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.read( (<span class="keywordtype">char</span> *)ch, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>) );
00413                                 }
00414 
00415                                 <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.read( (<span class="keywordtype">char</span> *)ch, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>) );
00416                                 temp=ch[0];
00417                                 <a class="code" href="classBibtool.html#Bibtoolo1">type</a>.insert( nameLength, temp );
00418                                 nameLength++;
00419 
00420                                 <span class="comment">//ignore white space after the read</span>
00421                                 <span class="keywordflow">while</span>( <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.peek() == <span class="charliteral">' '</span> ||
00422                                        <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.peek() == <span class="charliteral">'\n'</span> ||
00423                                        <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.peek() == 0x0d ||
00424                                        <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.peek() == <span class="charliteral">'\t'</span> )
00425                                 {
00426                                         <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.read( (<span class="keywordtype">char</span> *)ch, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>) );
00427                                 }
00428 
00429                         }
00430                         done = <span class="keyword">true</span>;                    <span class="comment">//done getting first entry type</span>
00431 
00432                         <span class="comment">//don't want to pay attention to comment</span>
00433                         string temp_type = <a class="code" href="classBibtool.html#Bibtoolo1">type</a>;
00434 
00435                         <span class="keywordflow">for</span>( <span class="keywordtype">int</span> x=0; x&lt;nameLength; x++ )       <span class="comment">//convert to lower case</span>
00436                                 temp_type[x] = tolower(temp_type[x]);
00437 
00438                         <span class="comment">//strcmpi does not work strcmp does! suppose to only need string.h include</span>
00439                         <span class="comment">//WHY?????</span>
00440                         <span class="comment">//if( strcmpi( type.c_str(), "comment" ) == 0 ||</span>
00441                         <span class="comment">//    strcmpi( type.c_str(), "preamble" ) == 0 )</span>
00442 
00443                         <span class="keywordflow">if</span>( temp_type == <span class="stringliteral">"comment"</span> ||
00444                             temp_type == <span class="stringliteral">"preamble"</span> ||
00445                             temp_type == <span class="stringliteral">"string"</span> )
00446                         {
00447                                 <a class="code" href="classBibtool.html#Bibtoolo6">validType</a> = <span class="keyword">false</span>;
00448                         }
00449                 }
00450         }
00451         <span class="keywordflow">return</span> foundEntry;
00452 }
00453 
00454 <span class="comment">//Open search list and extract names.  Reads in search names char by char</span>
00455 <span class="comment">//is an a= the search name is author</span>
00456 <span class="comment">//if a t= then search name is title</span>
<a name="l00457"></a><a class="code" href="classBibtool.html#Bibtoola4">00457</a> <span class="comment">//if nothing following word then search is for key name</span>
00458 <span class="keywordtype">void</span> <a class="code" href="classBibtool.html#Bibtoola4">Bibtool::getSchLst</a>()
00459 {
00460         <span class="keywordtype">char</span> ch[1];
00461         string temp_str, temp_ch;
00462         string::size_type temp_pos;
00463         <a class="code" href="structsearchName.html">searchName</a> foundKey_obj;
00464         <a class="code" href="structsearchName.html">searchName</a> foundAuth_obj;
00465         <a class="code" href="structsearchName.html">searchName</a> foundTitle_obj;
00466         <a class="code" href="classBibtool.html#Bibtoolm10">schLstIsOpenable</a> = <span class="keyword">false</span>;
00467 
00468         <span class="comment">//open file</span>
00469         ifstream schIn( <a class="code" href="classBibtool.html#Bibtoolm7">schLstFileName</a>.c_str(), ios::in );
00470         <span class="keywordflow">if</span>(!schIn) {    
00471                 cerr&lt;&lt; endl&lt;&lt; <span class="stringliteral">"&gt;&gt;Can not open search file: "</span>&lt;&lt; <a class="code" href="classBibtool.html#Bibtoolm7">schLstFileName</a>&lt;&lt; endl;
00472         } <span class="keywordflow">else</span> {
00473                 <a class="code" href="classBibtool.html#Bibtoolm10">schLstIsOpenable</a> = <span class="keyword">true</span>;
00474                 <span class="keywordflow">while</span>( schIn.peek() != EOF )
00475                 {
00476                         <span class="comment">//read in char by char</span>
00477                         <span class="keywordflow">while</span>( schIn.peek() == <span class="charliteral">' '</span> || schIn.peek() == <span class="charliteral">'\t'</span> )
00478                                 schIn.read( (<span class="keywordtype">char</span>*)ch, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>) );
00479 
00480                         schIn.read( (<span class="keywordtype">char</span>*)ch, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>) );
00481 
00482                         <span class="keywordflow">if</span>( ch[0] == <span class="charliteral">'a'</span> || ch[0] == <span class="charliteral">'A'</span> )
00483                         {
00484                                 <span class="keywordflow">while</span>( schIn.peek() == <span class="charliteral">' '</span> || schIn.peek() == <span class="charliteral">'\t'</span> )
00485                                         schIn.read( (<span class="keywordtype">char</span>*)ch, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>) );
00486 
00487                                 <span class="comment">//if next character is an = the we are dealing with author</span>
00488                                 <span class="keywordflow">if</span>( schIn.peek() == <span class="charliteral">'='</span> )
00489                                 {
00490                                         schIn.read( (<span class="keywordtype">char</span>*)ch, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>) );
00491 
00492                                         temp_str.erase();
00493                                         <span class="keywordflow">while</span>( schIn.peek() != <span class="charliteral">' '</span> &amp;&amp; schIn.peek() != <span class="charliteral">'&amp;'</span> &amp;&amp; schIn.peek() != <span class="charliteral">'\n'</span> &amp;&amp; schIn.peek() != 0x0d )
00494                                         {
00495                                                 schIn.read( (<span class="keywordtype">char</span>*)ch, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>) );
00496                                                 temp_ch = ch[0];
00497                                                 temp_str.insert( temp_str.length(), temp_ch );
00498                                         }
00499                                         <span class="comment">//convert to lowercase for compairson</span>
00500                                         <span class="keywordflow">for</span>( <span class="keywordtype">int</span> x=0; x&lt;temp_str.length(); x++)
00501                                         temp_str[x] = tolower( temp_str[x] );
00502 
00503                                         <span class="comment">//got author name, save to vector</span>
00504                                         foundAuth_obj.<a class="code" href="structsearchName.html#searchNamem0">name</a> = temp_str;
00505                                         <a class="code" href="classBibtool.html#Bibtoolm12">searchNamesAuth_vec</a>.push_back( foundAuth_obj );
00506                                 }
00507                         }
00508                          <span class="keywordflow">else</span> <span class="keywordflow">if</span>( ch[0] == <span class="charliteral">'t'</span> || ch[0] == <span class="charliteral">'T'</span> )
00509                         {
00510                                 <span class="keywordflow">while</span>( schIn.peek() == <span class="charliteral">' '</span> || schIn.peek() == <span class="charliteral">'\t'</span> )
00511                                         schIn.read( (<span class="keywordtype">char</span>*)ch, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>) );
00512 
00513                                 <span class="comment">//if next character is an = the we are dealing with title</span>
00514                                 <span class="keywordflow">if</span>( schIn.peek() == <span class="charliteral">'='</span> )
00515                                 {
00516                                         schIn.read( (<span class="keywordtype">char</span>*)ch, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>) );
00517 
00518                                         temp_str.erase();
00519                                         <span class="keywordflow">while</span>( schIn.peek() != <span class="charliteral">' '</span> &amp;&amp; schIn.peek() != <span class="charliteral">'&amp;'</span> &amp;&amp; schIn.peek() != <span class="charliteral">'\n'</span> &amp;&amp; schIn.peek() != 0x0d )
00520                                         {
00521                                                 schIn.read( (<span class="keywordtype">char</span>*)ch, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>) );
00522                                                 temp_ch = ch[0];
00523                                                 temp_str.insert( temp_str.length(), temp_ch );
00524                                         }
00525                                         <span class="comment">//convert to lowercase for compairson</span>
00526                                         <span class="keywordflow">for</span>( <span class="keywordtype">int</span> x=0; x&lt;temp_str.length(); x++)
00527                                         temp_str[x] = tolower( temp_str[x] );
00528 
00529                                         <span class="comment">//got author name, save to vector</span>
00530                                         foundTitle_obj.<a class="code" href="structsearchName.html#searchNamem0">name</a> = temp_str;
00531                                         <a class="code" href="classBibtool.html#Bibtoolm13">searchNamesTitle_vec</a>.push_back( foundTitle_obj );
00532                                 }
00533                         }
00534                         <span class="keywordflow">else</span>
00535                         {
00536                                 <span class="comment">//this is a normal search</span>
00537                                 temp_str.erase();
00538                                 temp_ch = ch[0];
00539                                 <span class="keywordflow">if</span>( ch[0] != <span class="charliteral">' '</span> &amp;&amp; ch[0] != <span class="charliteral">'\n'</span> &amp;&amp;
00540                                     ch[0] != 0x0d &amp;&amp; ch[0] != <span class="charliteral">'\t'</span> &amp;&amp; ch[0] != EOF )
00541                                 {
00542                                         <span class="comment">//first character is part of the string if not include in if above</span>
00543                                         temp_str.insert( temp_str.length(), temp_ch );
00544 
00545                                         <span class="keywordflow">while</span>( schIn.peek() != <span class="charliteral">' '</span> &amp;&amp; schIn.peek() != <span class="charliteral">'\n'</span> &amp;&amp;
00546                                                 schIn.peek() != 0x0d &amp;&amp; schIn.peek() != <span class="charliteral">'\t'</span> &amp;&amp;
00547                                                 schIn.peek() != EOF )
00548                                         {
00549                                                 schIn.read( (<span class="keywordtype">char</span>*)ch, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>) );
00550                                                 temp_ch = ch[0];
00551                                                 temp_str.insert( temp_str.length(), temp_ch );
00552                                         }
00553                                         <span class="comment">//convert to lowercase for compairson</span>
00554                                         <span class="keywordflow">for</span>( <span class="keywordtype">int</span> x=0; x&lt;temp_str.length(); x++)
00555                                         temp_str[x] = tolower( temp_str[x] );
00556 
00557                                         foundKey_obj.<a class="code" href="structsearchName.html#searchNamem0">name</a> = temp_str;
00558                                         <a class="code" href="classBibtool.html#Bibtoolm11">searchNames_vec</a>.push_back( foundKey_obj );
00559                                 }
00560                         }
00561 
00562                         <span class="comment">//if next char is a &amp; then search continues</span>
00563                         <span class="comment">//only hpaanes if it was a 'a' or 't'</span>
00564                         <span class="keywordflow">if</span>( schIn.peek() == <span class="charliteral">'&amp;'</span> )
00565                                 schIn.read( (<span class="keywordtype">char</span>*)ch, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>) );
00566                 }
00567         }
00568 }
00569 
<a name="l00570"></a><a class="code" href="classBibtool.html#Bibtoola10">00570</a> 
00571 <span class="keywordtype">void</span> <a class="code" href="classBibtool.html#Bibtoola10">Bibtool::displayFound</a>( vector&lt;searchName&gt; &amp;search_vec, <a class="code" href="bibtool_8h.html#a3">SearchType</a> idSearch )
00572 {
00573         <span class="keywordflow">for</span>( <span class="keywordtype">int</span> x=0; x&lt; search_vec.size(); x++ )
00574         {
00575                 <span class="keywordflow">if</span>( search_vec[x].found == <span class="keyword">true</span> )
00576                 {
00577                         <span class="keywordflow">if</span>( idSearch == <a class="code" href="bibtool_8h.html#a3a2">KEYNAME</a> )
00578                                 cout&lt;&lt; <span class="stringliteral">"Found key name: "</span>&lt;&lt; search_vec[x].name&lt;&lt; endl;
00579                         <span class="keywordflow">if</span>( idSearch == <a class="code" href="bibtool_8h.html#a3a0">AUTHOR</a> )
00580                                 cout&lt;&lt; <span class="stringliteral">"Found author name: "</span> &lt;&lt; search_vec[x].name&lt;&lt; endl;
00581                         <span class="keywordflow">if</span>( idSearch == <a class="code" href="bibtool_8h.html#a3a1">TITLE</a> )
00582                                 cout&lt;&lt; <span class="stringliteral">"Found title: "</span>&lt;&lt; search_vec[x].name&lt;&lt; endl;
00583                 }
00584         }
00585 }
00586 
00587 
<a name="l00588"></a><a class="code" href="classBibtool.html#Bibtoola6">00588</a> <span class="comment">//Open a file</span>
00589 <span class="keywordtype">bool</span> <a class="code" href="classBibtool.html#Bibtoola6">Bibtool::openFileBinary</a>( string fileName )
00590 {
00591         <span class="keywordtype">bool</span> fileOpenSuccess = <span class="keyword">true</span>;
00592 
00593         <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.clear();    <span class="comment">//object flags have to be reset.. </span>
00594                         <span class="comment">//if not fin is FALSE and even though open is success</span>
00595                         <span class="comment">//fin remains false and states that file is not open.</span>
00596                         <span class="comment">//WHY? Does .open function no reset the fail bit????????</span>
00597                         <span class="comment">//gcc.gnu.org/ml/libstdc++/2001-09/msg00036.html</span>
00598 
00599         <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.open( fileName.c_str(), ios::in | ios::binary );
00600 
00601         <span class="keywordflow">if</span>(!<a class="code" href="classBibtool.html#Bibtoolo0">fin</a>) {
00602                 cerr&lt;&lt; <span class="stringliteral">"--Can not open file: "</span>&lt;&lt; fileName&lt;&lt; endl;
00603                 fileOpenSuccess = <span class="keyword">false</span>;
00604         }
00605 
00606         <span class="keywordflow">return</span> fileOpenSuccess;
00607 }
00608 
00609 
<a name="l00610"></a><a class="code" href="classBibtool.html#Bibtoola7">00610</a> <span class="comment">//Close a file</span>
00611 <span class="keywordtype">void</span> <a class="code" href="classBibtool.html#Bibtoola7">Bibtool::closeFile</a>()
00612 {
00613         <a class="code" href="classBibtool.html#Bibtoolo0">fin</a>.close();
00614 }
00615 
00616 
<a name="l00617"></a><a class="code" href="classBibtool.html#Bibtoola8">00617</a> <span class="comment">//delete files from previous run that we are going to write to</span>
00618 <span class="keywordtype">void</span> <a class="code" href="classBibtool.html#Bibtoola8">Bibtool::removeOldFiles</a>()
00619 {
00620         remove( <a class="code" href="classBibtool.html#Bibtoolm1">outFileName</a>.c_str() );
00621         remove( <a class="code" href="classBibtool.html#Bibtoolm2">outFileNameBibs</a>.c_str() );
00622         remove( <a class="code" href="classBibtool.html#Bibtoolm8">schLstFileOut</a>.c_str() );
00623         remove( <a class="code" href="classBibtool.html#Bibtoolm3">ndx_authorFN</a>.c_str() );
00624         remove( <a class="code" href="classBibtool.html#Bibtoolm4">lst_authorFN</a>.c_str() );
00625         remove( <a class="code" href="classBibtool.html#Bibtoolm5">ndx_titleFN</a>.c_str() );
00626         remove( <a class="code" href="classBibtool.html#Bibtoolm6">lst_titleFN</a>.c_str() );
00627 }
00628 
00629 
00630 <span class="comment">//Print Help message</span>
<a name="l00631"></a><a class="code" href="classBibtool.html#Bibtoola1">00631</a> <span class="comment">//Shows correct usage of bibtool</span>
00632 <span class="keywordtype">void</span> <a class="code" href="classBibtool.html#Bibtoola1">Bibtool::printHelp</a>()
00633 {
00634         cout&lt;&lt; <span class="stringliteral">"bibtool manages BibTex data files by maintaining an index file."</span>&lt;&lt; endl&lt;&lt; endl;
00635         cout&lt;&lt; <span class="stringliteral">"Usage: bibtool datafile1 datafile2 ... datafilen [index_filename] "</span>
00636             &lt;&lt; <span class="stringliteral">"[-s searchList_filename]"</span>&lt;&lt; endl&lt;&lt; endl;
00637         cout&lt;&lt; <span class="stringliteral">"Example:"</span>&lt;&lt; endl;
00638         cout&lt;&lt; <span class="stringliteral">"   bibtool first.bib second.bib bibindex -s searchnames.txt"</span>&lt;&lt; endl&lt;&lt; endl;
00639         cout&lt;&lt; <span class="stringliteral">"Online Documentation: http://ecst.csuchico.edu/~srippee"</span>&lt;&lt; endl&lt;&lt;endl;
00640 }
00641 
00642 
00643 
00644 
00645 
00646 
00647 
00648 
00649 
00650 
00651 
00652 
00653 
00654 
00655 
00656 
00657 
00658 
00659 
00660 
00661 
00662 
00663 
</pre></div><hr><address style="align: right;"><small>Generated on Thu Apr 17 05:03:42 2003 for bibtool by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.3-rc1 </small></address>
</body>
</html>
